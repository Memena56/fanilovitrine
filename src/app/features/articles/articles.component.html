<section class="relative isolate overflow-hidden px-4 py-8 sm:px-6 sm:py-12 lg:px-12 font-sans">
  <div class="max-w-7xl mx-auto flex flex-col lg:grid lg:grid-cols-4 lg:gap-12">
    <!-- SIDEBAR (Accordion / Filtering) -->
    <aside class="mb-8 lg:mb-0 lg:col-span-1 lg:sticky lg:top-24 self-start">
      <div class="bg-gradient-to-br from-indigo-900/80 via-purple-800/60 to-indigo-700/80 rounded-2xl shadow-md p-6 border border-white/10 backdrop-blur">
        <h2 class="text-xl font-semibold text-white mb-6">Ny vokatra misy</h2>
        <app-category-accordeon
          [categories]="categoriesTrees"
          [selectedCategoryIds]="selectedCategoryIds"
          (categoryFilterChange)="onCategoryFilterChange($event)">
        </app-category-accordeon>
      </div>
    </aside>

    <!-- MAIN ARTICLE GRID -->
    <div class="lg:col-span-3 space-y-8">
      <!-- Carrousel -->
      <div class="relative w-full h-64 flex items-center justify-center rounded-2xl overflow-hidden mb-8 bg-white">
        <img src="/frontend/assets/caroussel.png" alt="Banner fanilo shop"
            class="max-h-full max-w-full object-contain rounded-2xl" />
      </div>

      <!-- Barre de recherche -->
      <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
        <input [(ngModel)]="searchTerm" (input)="onSearchChange()"
          type="text" placeholder="Mitady vokatra..."
          class="border border-indigo-200 rounded-lg px-4 py-2 w-full md:w-1/2 focus:ring-2 focus:ring-indigo-300 transition" />
        <button class="p-2 border border-indigo-600 rounded-lg hover:bg-indigo-600 hover:text-white text-indigo-600 transition"
            (click)="goToArticlesDashboardOrLogin()"
            title="Hampiditra vokatra vaovao">
          <svg class="w-5 h-5 inline-block" fill="none" stroke="currentColor" stroke-width="2"
              viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M12 4v1m0 14v1m8.66-6.66l-.71.71M4.05 4.05l.71.71M21 12h-1M4 12H3m2.34 6.66l-.71-.71M19.95 4.05l-.71.71M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
        </button>
      </div>

      <!-- Liste des articles -->
      <div class="grid gap-8 sm:grid-cols-2 xl:grid-cols-3">
        <div *ngFor="let a of filteredArticles"
          class="bg-white border border-gray-50 rounded-2xl overflow-hidden cursor-pointer shadow transition hover:shadow-xl hover:-translate-y-1 hover:bg-indigo-50/60 duration-400"
          (click)="goToDetail(a.slug)">
          <img [src]="a.images[0]" class="h-48 w-full object-contain object-center rounded-t-2xl bg-white" />
          <div class="p-5">
            <h5 class="font-bold text-gray-900 truncate mb-1">{{ a.title }}</h5>
            <p class="text-sm text-gray-500">{{ a.price }} {{ a.currency }}</p>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <div class="flex flex-wrap justify-center items-center gap-4 mt-10">
        <button *ngFor="let p of [].constructor(totalPages); let i = index"
                (click)="goToPage(i+1)"
                [class.bg-indigo-600]="currentPage===i+1"
                [class.text-white]="currentPage===i+1"
                class="px-4 py-2 rounded-lg text-sm border border-indigo-500 text-indigo-600 hover:bg-indigo-100 transition">
          {{ i+1 }}
        </button>
      </div>
    </div>
  </div>
</section>
